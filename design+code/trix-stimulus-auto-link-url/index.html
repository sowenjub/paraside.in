<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="üèù Living in Paraside"/><link rel="canonical" href="https://paraside.in/design+code/trix-stimulus-auto-link-url"/><meta name="twitter:url" content="https://paraside.in/design+code/trix-stimulus-auto-link-url"/><meta name="og:url" content="https://paraside.in/design+code/trix-stimulus-auto-link-url"/><title>Auto-linking URLs with Trix Editor and StimulusJS | üèù Living in Paraside</title><meta name="twitter:title" content="Auto-linking URLs with Trix Editor and StimulusJS | üèù Living in Paraside"/><meta name="og:title" content="Auto-linking URLs with Trix Editor and StimulusJS | üèù Living in Paraside"/><meta name="description" content="Auto-linking URLs with Trix Editor and StimulusJS"/><meta name="twitter:description" content="Auto-linking URLs with Trix Editor and StimulusJS"/><meta name="og:description" content="Auto-linking URLs with Trix Editor and StimulusJS"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to üèù Living in Paraside"/><meta name="twitter:image" content="https://paraside.in/social.png"/><meta name="og:image" content="https://paraside.in/social.png"/></head><body class="bg-white font-sans leading-normal tracking-normal"><div class="pb-16"><nav class="fixed z-10 bg-gray-900 p-4 mt-0 w-full overflow-auto scrolling-touch"><div class="container mx-auto flex items-center"><div class="flex-shrink-0 text-white font-extrabold"><a class="flex text-white text-base no-underline hover:text-white hover:no-underline" href="/"><span class="block md:hidden md:w-auto pl-1">üèù</span><span class="hidden md:block w-0 md:w-auto pl-1">üèù Living in Paraside</span></a></div><div class=" flex flex-no-wrap pl-4 text-sm"><ul class="list-reset flex justify-between items-center"><li class="mr-2"><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-2" href="/">HOME</a></li><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-2 whitespace-no-wrap" href="/about">ABOUT</a></li><li><a class="inline-block py-2 px-2 text-white no-underline hover:underline whitespace-no-wrap" href="/design+code">DESIGN+CODE</a></li></ul></div></div></nav></div><div class="text-center pt-16 md:pt-32"><p class="text-xs md:text-sm text-casper-blue font-bold">20 OCTOBER 2020<span class="text-gray-900 px-1">/</span><a href="/tags/rails">RAILS</a></p><h1 class="font-bold break-normal text-3xl md:text-5xl max-w-6xl mx-auto">Auto-linking URLs with Trix Editor and StimulusJS</h1></div><div class="container w-full max-w-6xl h-48 md:h-cover mx-auto bg-white bg-cover bg-center mt-8 sm:rounded" style="background-color: #424242; background-image:url('/covers/rails-link.png');"></div><div class="container max-w-5xl mx-auto md:-mt-32"><div class="mx-0 sm:mx-6"><main class="bg-white w-full p-8 md:p-24 text-gray-800 leading-normal"><article class="prose prose-sm sm:prose-xl break-words"><p>The <a href="https://trix-editor.org/">https://trix-editor.org</a> is fantastic, but there's one simple thing I expected to be built-in that isn't: copy/pasting a URL should create a link automatically instead of inserting the link as plain text.</p><p>Thinking of it, it's not so surprising because there are many things one could want to do instead, like embedding a video or a tweet. But it's a <a href="https://github.com/basecamp/trix/issues/167">common request</a>, and the GitHub issue includes a solution with jQuery that I used to build my Stimulus controller.</p><p>So, without further ado, here's a simple 2 steps rails tutorial to add URL auto-linking to your forms.</p><h1>The controller</h1><p>Create a <code>/app/javascript/controller/trix_paste_controller.js</code> file and copy/paste the code below.</p><pre><code><div class="highlight"><span></span><span class="kd">import</span> <span class="p">{</span> <span class="nc">Controller</span> <span class="p">}</span> <span class="nc">from</span> <span class="s">&quot;stimulus&quot;</span>

<span class="n">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nc">extends</span> <span class="n">Controller</span> <span class="p">{</span>
  <span class="n">connect</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">document</span><span class="p">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s">&quot;paste&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="n">pasteHandler</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="n">this</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="n">disconnect</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">document</span><span class="p">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="s">&quot;paste&quot;</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="n">pasteHandler</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="n">this</span><span class="p">))</span>
  <span class="p">}</span>

  <span class="n">pasteHandler</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">pastedText</span> <span class="p">=</span> <span class="n">event</span><span class="p">.</span><span class="n">clipboardData</span><span class="p">?.</span><span class="n">getData</span><span class="p">?.(</span><span class="s">&quot;Text&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!!</span><span class="n">pastedText</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="n">pastedText</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="o">/^</span><span class="p">(</span><span class="n">https</span><span class="p">?:</span><span class="err">\</span><span class="o">/</span><span class="err">\</span><span class="o">/</span><span class="p">(?:</span><span class="n">www</span><span class="err">\</span><span class="p">.</span><span class="o">|</span><span class="p">(?</span><span class="o">!</span><span class="n">www</span><span class="p">))[</span><span class="o">^</span><span class="err">\</span><span class="n">s</span><span class="err">\</span><span class="p">.]</span><span class="o">+</span><span class="err">\</span><span class="p">.[</span><span class="o">^</span><span class="err">\</span><span class="n">s</span><span class="p">]{</span><span class="mi">2</span><span class="p">,}</span><span class="o">|</span><span class="n">www</span><span class="err">\</span><span class="p">.[</span><span class="o">^</span><span class="err">\</span><span class="n">s</span><span class="p">]</span><span class="o">+</span><span class="err">\</span><span class="p">.[</span><span class="o">^</span><span class="err">\</span><span class="n">s</span><span class="p">]{</span><span class="mi">2</span><span class="p">,})</span><span class="err">$</span><span class="o">/</span><span class="n">ig</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">this</span><span class="p">.</span><span class="n">pasteUrl</span><span class="p">(</span><span class="n">pastedText</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">pasteUrl</span><span class="p">(</span><span class="n">pastedText</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">editor</span> <span class="p">=</span> <span class="n">this</span><span class="p">.</span><span class="n">element</span><span class="p">.</span><span class="n">editor</span>
    <span class="kd">let</span> <span class="nv">currentText</span> <span class="p">=</span> <span class="n">editor</span><span class="p">.</span><span class="n">getDocument</span><span class="p">().</span><span class="bp">toString</span><span class="p">()</span>
    <span class="kd">let</span> <span class="nv">currentSelection</span> <span class="p">=</span> <span class="n">editor</span><span class="p">.</span><span class="n">getSelectedRange</span><span class="p">()</span>
    <span class="kd">let</span> <span class="nv">textWeAreInterestedIn</span> <span class="p">=</span> <span class="n">currentText</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">currentSelection</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="kd">let</span> <span class="nv">startOfPastedText</span> <span class="p">=</span> <span class="n">textWeAreInterestedIn</span><span class="p">.</span><span class="n">lastIndexOf</span><span class="p">(</span><span class="n">pastedText</span><span class="p">)</span>
    <span class="n">editor</span><span class="p">.</span><span class="n">recordUndoEntry</span><span class="p">(</span><span class="s">&quot;Auto Link Paste&quot;</span><span class="p">)</span>
    <span class="n">editor</span><span class="p">.</span><span class="n">setSelectedRange</span><span class="p">([</span><span class="n">startOfPastedText</span><span class="p">,</span> <span class="n">currentSelection</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">editor</span><span class="p">.</span><span class="n">activateAttribute</span><span class="p">(</span><span class="err">&#39;</span><span class="n">href</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">pastedText</span><span class="p">)</span>
    <span class="n">editor</span><span class="p">.</span><span class="n">setSelectedRange</span><span class="p">(</span><span class="n">currentSelection</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</div></code></pre><h1>Your forms</h1><p>And now, anytime you want need this auto-linking feature, just reference the controller like so:</p><pre><code><div class="highlight"><span></span><span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rich_text_area</span> <span class="ss">:content</span><span class="p">,</span> <span class="ss">data</span><span class="p">:</span> <span class="p">{</span> <span class="ss">controller</span><span class="p">:</span> <span class="s2">&quot;trix-paste&quot;</span> <span class="p">}</span>
</div></code></pre><p>That's it, and it's "trix-paste" and not "trix-autolink" because I have further plans for this controller.</p></article></main><div class="flex flex-wrap w-full items-center font-sans p-8 md:p-24"><div class="md:flex-1 flex"><img class="w-10 h-10 rounded-full mr-4" src="/arnaud_joubay.jpg" alt="Arnaud Joubay"/><div class="flex-1"><p class="text-base font-bold text-base md:text-xl leading-none">Arnaud Joubay</p><p class="text-gray-600 text-xs md:text-base">Swift &amp; Rails Indie Maker. Original Parasider. Time Knight. 11y Remote/WFH. Half of @teambkry. Creator of cows in App Store featured @nomeat_today. Scuba diver.üë®‚Äçüíªüêïüêãü•êüêÆüçâüå±.</p></div></div><div class="mt-8 md:mt-0 mx-auto md:mx-0 md:justify-end"><a class="bg-transparent border border-gray-500 hover:border-casper-blue text-xs text-gray-500 hover:text-casper-blue font-bold py-2 px-4 rounded-full" href="/tags">All tags</a></div></div></div></div><div class="bg-gray-200"><div class="container w-full max-w-6xl mx-auto px-2 py-8"><div class="grid grid-cols-1 sm:grid-cols-3 gap-12"><div class="w-full  py-6 flex flex-col flex-grow flex-shrink transform transition duration-200 ease-in-out hover:scale-105"><div class="flex-1 bg-white rounded-t rounded-b-none overflow-hidden shadow-lg"><a href="/design+code/system-test-withs-cuprite" class="flex flex-wrap no-underline hover:no-underline"><img src="/covers/railstests.png" class="h-64 w-full rounded-t object-cover"/><p class="w-full text-casper-blue text-xs font-medium pt-6 px-6">RAILS</p><div class="w-full font-bold text-2xl text-gray-900 px-6">Replacing Selenium with Cuprite for Rails system tests</div><p class="text-gray-800 font-serif text-lg px-6 mb-5">A quick-start guide for rspec-less system tests with Cuprite</p></a></div><div class="flex-none mt-auto bg-white rounded-b rounded-t-none overflow-hidden shadow-lg p-6"><div class="flex items-center justify-between"><img class="w-8 h-8 rounded-full mr-4 avatar" src="/arnaud_joubay.jpg" alt="Arnaud Joubay"/><p class="text-gray-600 text-xs md:text-sm">5 MIN READ</p></div></div></div><div class="w-full  py-6 flex flex-col flex-grow flex-shrink transform transition duration-200 ease-in-out hover:scale-105"><div class="flex-1 bg-white rounded-t rounded-b-none overflow-hidden shadow-lg"><a href="/design+code/emoji-picker-controller-with-stimulus-js" class="flex flex-wrap no-underline hover:no-underline"><img src="/covers/emoji.png" class="h-64 w-full rounded-t object-cover"/><p class="w-full text-casper-blue text-xs font-medium pt-6 px-6">RAILS</p><div class="w-full font-bold text-2xl text-gray-900 px-6">Emoji picker controller with StimulusJS and Emoji Button</div><p class="text-gray-800 font-serif text-lg px-6 mb-5">Adding an emoji picker to a Rails app</p></a></div><div class="flex-none mt-auto bg-white rounded-b rounded-t-none overflow-hidden shadow-lg p-6"><div class="flex items-center justify-between"><img class="w-8 h-8 rounded-full mr-4 avatar" src="/arnaud_joubay.jpg" alt="Arnaud Joubay"/><p class="text-gray-600 text-xs md:text-sm">1 MIN READ</p></div></div></div><div class="w-full  py-6 flex flex-col flex-grow flex-shrink transform transition duration-200 ease-in-out hover:scale-105"><div class="flex-1 bg-white rounded-t rounded-b-none overflow-hidden shadow-lg"><a href="/design+code/publish+tailwindcss" class="flex flex-wrap no-underline hover:no-underline"><img src="/covers/tailwindcss.png" class="h-64 w-full rounded-t object-cover"/><p class="w-full text-casper-blue text-xs font-medium pt-6 px-6">SWIFT</p><div class="w-full font-bold text-2xl text-gray-900 px-6">Power your Publish (Swift) static site with Tailwind CSS</div><p class="text-gray-800 font-serif text-lg px-6 mb-5">Learn how to create your own Publish theme and style it using Tailwind CSS.</p></a></div><div class="flex-none mt-auto bg-white rounded-b rounded-t-none overflow-hidden shadow-lg p-6"><div class="flex items-center justify-between"><img class="w-8 h-8 rounded-full mr-4 avatar" src="/arnaud_joubay.jpg" alt="Arnaud Joubay"/><p class="text-gray-600 text-xs md:text-sm">8 MIN READ</p></div></div></div></div></div></div><footer class="bg-gray-900"><div class="container max-w-6xl mx-auto flex items-center px-2 pt-2 pb-8"><div class="w-full mx-auto flex flex-wrap items-center"><div class="flex w-full md:w-1/2 justify-center md:justify-start text-white font-extrabold"><p><a class="text-gray-900 no-underline hover:text-gray-900 hover:no-underline" href="#"><span class="text-base text-gray-200">üèù Living in Paraside</span></a></p></div><div class="flex w-full pt-2 content-center justify-between md:w-1/2 md:justify-end"><ul class="list-reset flex justify-center flex-1 md:flex-none items-center"><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-3 text-sm" href="/">Latest Posts</a></li><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-3 text-sm" href="https://github.com/JohnSundell/Publish">Publish</a></li><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline py-2 px-3 text-sm" href="https://ghost.org">Ghost</a></li><li><a class="inline-block text-gray-600 no-underline hover:text-gray-200 hover:underline px-3 text-sm" href="/feed.rss"><svg class="fill-current h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg></a></li></ul></div></div></div></footer></body></html>